#!/usr/bin/ruby

# Translation of: http://rosettacode.org/wiki/Zig-zag_matrix#Perl

func zig_zag(w, h) {

    var r = [];
    var n = 0;

    range(0, h-1).map { |e|
        range(0, w-1).map { |f|
            [e, f]
        }
    }
    -> reduce('+')
    -> sort { |a, b|
           (a[0]+a[1] <=> b[0]+b[1])
        || (a[0]+a[1] %% 2 ? a[0]<=>b[0]
                           : a[1]<=>b[1])
    }
    -> each { |a|
       r[a[1]][a[0]] = n++;
    };

    return r;
}

zig_zag(4, 4).each {.join('', {|i| "%4i" % i}).say};
